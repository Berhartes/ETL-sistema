rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // ‚ùå REGRA PERIGOSA REMOVIDA - Esta regra permitia acesso total
    // ‚ùå match /{document=**} { allow read, write: if true; }
    // 
    // ‚úÖ REGRAS SEGURAS IMPLEMENTADAS ABAIXO
    // Apenas leitura p√∫blica para dados de transpar√™ncia
    // Escritas APENAS via Firebase Admin SDK (ETL)

    // Regras para produ√ß√£o
    // ‚úÖ DADOS DE TRANSPAR√äNCIA P√öBLICA - APENAS LEITURA
    // Escritas s√£o feitas APENAS via Firebase Admin SDK no ETL
    
    match /congressoNacional/{document=**} {
      allow read: if true;
      allow write: if false; // ‚úÖ Escritas BLOQUEADAS do lado cliente
    }

    match /senadores/{document=**} {
      allow read: if true;
      allow write: if false; // ‚úÖ Escritas BLOQUEADAS do lado cliente
    }

    match /legislaturas/{document=**} {
      allow read: if true;
      allow write: if false; // ‚úÖ Escritas BLOQUEADAS do lado cliente
    }

    match /votacoes/{document=**} {
      allow read: if true;
      allow write: if false; // ‚úÖ Escritas BLOQUEADAS do lado cliente
    }

    match /perfilfornecedores/{document=**} {
      allow read: if true;
      allow write: if false; // ‚úÖ Escritas BLOQUEADAS do lado cliente
    }

    // üèõÔ∏è DADOS PRINCIPAIS DE TRANSPAR√äNCIA
    match /despesas/{document=**} {
      allow read: if true;
      allow write: if false; // ‚úÖ ESCRITAS APENAS VIA ETL/ADMIN SDK
    }

    match /rankings/{document=**} {
      allow read: if true;
      allow write: if false; // ‚úÖ ESCRITAS APENAS VIA ETL/ADMIN SDK
    }

    match /alertas/{document=**} {
      allow read: if true;
      allow write: if false; // ‚úÖ ESCRITAS APENAS VIA ETL/ADMIN SDK
    }

    match /estatisticas/{document=**} {
      allow read: if true;
      allow write: if false; // ‚úÖ ESCRITAS APENAS VIA ETL/ADMIN SDK
    }

    match /indices/{document=**} {
      allow read: if true;
      allow write: if false; // ‚úÖ ESCRITAS APENAS VIA ETL/ADMIN SDK
    }

    match /metadados/{document=**} {
      allow read: if true;
      allow write: if false; // ‚úÖ ESCRITAS APENAS VIA ETL/ADMIN SDK
    }

    match /transacoes/{document=**} {
      allow read: if true;
      allow write: if false; // ‚úÖ ESCRITAS APENAS VIA ETL/ADMIN SDK
    }

    match /fornecedores/{document=**} {
      allow read: if true;
      allow write: if false; // ‚úÖ ESCRITAS APENAS VIA ETL/ADMIN SDK
    }

    match /deputados/{document=**} {
      allow read: if true;
      allow write: if false; // ‚úÖ ESCRITAS APENAS VIA ETL/ADMIN SDK
    }

    // üìä ETL COLLECTIONS - Admin SDK access only
    match /etl_sessions/{document=**} {
      allow read: if true;
      allow write: if false; // ‚úÖ ESCRITAS APENAS VIA ETL/ADMIN SDK
    }
    
    match /etl_stats/{document=**} {
      allow read: if true;
      allow write: if false; // ‚úÖ ESCRITAS APENAS VIA ETL/ADMIN SDK
    }

    match /test/{document=**} {
      allow read, write: if true; // üß™ TEMPOR√ÅRIO - para testar Admin SDK
    }

    // üõ°Ô∏è REGRA PADR√ÉO SEGURA - NEGA TODO ACESSO N√ÉO ESPECIFICADO
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
